<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Data.LVar.Generic.Internal</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Data-LVar-Generic-Internal.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">lvish-2.0: Parallel scheduler, LVar data structures, and infrastructure to build more.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Unsafe</td></tr></table><p class="caption">Data.LVar.Generic.Internal</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module contains the unsafe bits that we cannot expose from 
  <a href="Data-LVar-Generic.html">Data.LVar.Generic</a>.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">class</span> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Foldable.html#t:Foldable">Foldable</a> (f <a href="Control-LVish-DeepFrz-Internal.html#t:Trvrsbl">Trvrsbl</a>) =&gt; <a href="#t:LVarData1">LVarData1</a> f  <span class="keyword">where</span><ul class="subs"><li><a href="#v:addHandler">addHandler</a> ::  <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-LVish.html#t:HandlerPool">HandlerPool</a> -&gt; f s elt -&gt; (elt -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s ()) -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s ()</li><li><a href="#v:freeze">freeze</a> :: HasFreeze e =&gt; f s a -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s (f <a href="Control-LVish-DeepFrz-Internal.html#t:Frzn">Frzn</a> a)</li><li><a href="#v:sortFrzn">sortFrzn</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> a =&gt; f <a href="Control-LVish-DeepFrz-Internal.html#t:Frzn">Frzn</a> a -&gt; <a href="Data-LVar-Generic-Internal.html#t:AFoldable">AFoldable</a> a</li></ul></li><li class="src short"><span class="keyword">class</span>  <a href="#t:LVarWBottom">LVarWBottom</a> f  <span class="keyword">where</span><ul class="subs"><li><span class="keyword">type</span> <a href="#t:LVContents">LVContents</a> f a :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/GHC-Exts.html#t:Constraint">Constraint</a></li><li><a href="#v:newBottom">newBottom</a> :: <a href="Data-LVar-Generic-Internal.html#t:LVContents">LVContents</a> f a =&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s (f s a)</li></ul></li><li class="src short"><span class="keyword">data</span>  <a href="#t:AFoldable">AFoldable</a> a = <span class="keyword">forall</span> f2 . <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Foldable.html#t:Foldable">Foldable</a> f2 =&gt; <a href="#v:AFoldable">AFoldable</a> (f2 a)</li><li class="src short"><a href="#v:unsafeCoerceLVar">unsafeCoerceLVar</a> :: <a href="Data-LVar-Generic-Internal.html#t:LVarData1">LVarData1</a> f =&gt; f s1 a -&gt; f s2 b</li><li class="src short"><a href="#v:unsafeTraversable">unsafeTraversable</a> :: <a href="Data-LVar-Generic-Internal.html#t:LVarData1">LVarData1</a> f =&gt; f <a href="Control-LVish-DeepFrz-Internal.html#t:Frzn">Frzn</a> a -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> (f <a href="Control-LVish-DeepFrz-Internal.html#t:Trvrsbl">Trvrsbl</a> a)</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">class</span> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Foldable.html#t:Foldable">Foldable</a> (f <a href="Control-LVish-DeepFrz-Internal.html#t:Trvrsbl">Trvrsbl</a>) =&gt; <a name="t:LVarData1" class="def">LVarData1</a> f  <span class="keyword">where</span></p><div class="doc"><p>A class representing monotonic data structures that take <em>one</em> type
 parameter, as well as an <code>s</code> parameter for session safety.
</p><p>LVars that fall into this class are typically collection types.
</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:addHandler" class="def">addHandler</a> ::  <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Control-LVish.html#t:HandlerPool">HandlerPool</a> -&gt; f s elt -&gt; (elt -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s ()) -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s ()</p><div class="doc"><p>Add a handler function which is called whenever an element is
 added to the LVar.
</p></div><p class="src"><a name="v:freeze" class="def">freeze</a> :: HasFreeze e =&gt; f s a -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s (f <a href="Control-LVish-DeepFrz-Internal.html#t:Frzn">Frzn</a> a)</p><div class="doc"><p>An <em>O(1)</em> operation that atomically switches the LVar into a
 frozen state.  Any threads waiting on the freeze are woken.
</p><p>The contents of a frozen LVar are fully observable:
 e.g., a whole set instead of one element, or the full/empty
 information for an IVar, instead of just the payload.
</p><p>However, note that <code><a href="Control-LVish-DeepFrz-Internal.html#t:Frzn">Frzn</a></code> LVars cannot be folded, because they may have
 nondeterministic ordering after being frozen.  See <code>sortFreeze</code>.
</p></div><p class="src"><a name="v:sortFrzn" class="def">sortFrzn</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> a =&gt; f <a href="Control-LVish-DeepFrz-Internal.html#t:Frzn">Frzn</a> a -&gt; <a href="Data-LVar-Generic-Internal.html#t:AFoldable">AFoldable</a> a</p><div class="doc"><p>Perform a freeze followed by a <em>sort</em> operation which guarantees
 that the elements produced will be produced in a deterministic order.
 The result is fully accessible to the user (<code>Foldable</code>).
</p></div></div><div class="subs instances"><p id="control.i:LVarData1" class="caption collapser" onclick="toggleSection('i:LVarData1')">Instances</p><div id="section.i:LVarData1" class="show"><table><tr><td class="src"><a href="Data-LVar-Generic-Internal.html#t:LVarData1">LVarData1</a> <a href="Data-LVar-IVar.html#t:IVar">IVar</a></td><td class="doc"><p>An <code><a href="Data-LVar-IVar.html#t:IVar">IVar</a></code> can be treated as a generic container LVar which happens to
 contain at most one value!  Note, however, that the polymorphic operations are
 less useful than the monomorphic ones exposed by this module.
</p></td></tr><tr><td class="src"><a href="Data-LVar-Generic-Internal.html#t:LVarData1">LVarData1</a> <a href="Data-LVar-IStructure.html#t:IStructure">IStructure</a></td><td class="doc"><p>An <code><a href="Data-LVar-IStructure.html#t:IStructure">IStructure</a></code> can be treated as a generic container LVar.  However, the
 polymorphic operations are less useful than the monomorphic ones exposed by this
 module (e.g., <code>forEachHP</code> vs. <code>addHandler</code>).
</p></td></tr><tr><td class="src"><a href="Data-LVar-Generic-Internal.html#t:LVarData1">LVarData1</a> <a href="Data-LVar-PureSet.html#t:ISet">ISet</a></td><td class="doc"><p>An <code><a href="Data-LVar-PureSet.html#t:ISet">ISet</a></code> can be treated as a generic container LVar.  However, the polymorphic
 operations are less useful than the monomorphic ones exposed by this module.
</p></td></tr><tr><td class="src"><a href="Data-LVar-Generic-Internal.html#t:LVarData1">LVarData1</a> <a href="Data-LVar-SLSet.html#t:ISet">ISet</a></td><td class="doc"><p>An <code><a href="Data-LVar-SLSet.html#t:ISet">ISet</a></code> can be treated as a generic container LVar.
</p></td></tr><tr><td class="src"><a href="Data-LVar-Generic-Internal.html#t:LVarData1">LVarData1</a> (<a href="Data-LVar-PureMap-Unsafe.html#t:IMap">IMap</a> k)</td><td class="doc"><p>An <code><a href="Data-LVar-PureMap-Unsafe.html#t:IMap">IMap</a></code> can be treated as a generic container LVar.  However, the polymorphic
 operations are less useful than the monomorphic ones exposed by this module.
</p></td></tr><tr><td class="src"><a href="Data-LVar-Generic-Internal.html#t:LVarData1">LVarData1</a> (<a href="Data-LVar-SLMap.html#t:IMap">IMap</a> k)</td><td class="doc"><p>An <code><a href="Data-LVar-SLMap.html#t:IMap">IMap</a></code> can be treated as a generic container LVar.  However, the polymorphic
 operations are less useful than the monomorphic ones exposed by this module.
</p></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span>  <a name="t:LVarWBottom" class="def">LVarWBottom</a> f  <span class="keyword">where</span></p><div class="doc"><p>A class enabling generic creation of new LVars.
</p></div><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a name="t:LVContents" class="def">LVContents</a> f a :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/GHC-Exts.html#t:Constraint">Constraint</a></p><div class="doc"><p>Requirements for contents types of this LVar.
</p></div></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:newBottom" class="def">newBottom</a> :: <a href="Data-LVar-Generic-Internal.html#t:LVContents">LVContents</a> f a =&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s (f s a)</p></div><div class="subs instances"><p id="control.i:LVarWBottom" class="caption collapser" onclick="toggleSection('i:LVarWBottom')">Instances</p><div id="section.i:LVarWBottom" class="show"><table><tr><td class="src"><a href="Data-LVar-Generic-Internal.html#t:LVarWBottom">LVarWBottom</a> <a href="Data-LVar-IVar.html#t:IVar">IVar</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Data-LVar-Generic-Internal.html#t:LVarWBottom">LVarWBottom</a> <a href="Data-LVar-SLSet.html#t:ISet">ISet</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:AFoldable" class="def">AFoldable</a> a </p><div class="doc"><p>Carries a <code>Foldable</code> type, but you don't get to know which one.
   The purpose of this type is that <code>sortFreeze</code> should not have
   to impose a particular memory representation.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><span class="keyword">forall</span> f2 . <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Foldable.html#t:Foldable">Foldable</a> f2 =&gt; <a name="v:AFoldable" class="def">AFoldable</a> (f2 a)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:AFoldable" class="caption collapser" onclick="toggleSection('i:AFoldable')">Instances</p><div id="section.i:AFoldable" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> a =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> (<a href="Data-LVar-Generic-Internal.html#t:AFoldable">AFoldable</a> a)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:unsafeCoerceLVar" class="def">unsafeCoerceLVar</a> :: <a href="Data-LVar-Generic-Internal.html#t:LVarData1">LVarData1</a> f =&gt; f s1 a -&gt; f s2 b</p><div class="doc"><p>A safer version of <code><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/ghc-prim-0.3.0.0/GHC-Prim.html#v:unsafeCoerce-35-">unsafeCoerce#</a></code> (that is, with a slightly more constrained type) for LVars only.
   Note, that the type of the LVar's contents must be allowed to change, because freezing is recursive.
</p></div></div><div class="top"><p class="src"><a name="v:unsafeTraversable" class="def">unsafeTraversable</a> :: <a href="Data-LVar-Generic-Internal.html#t:LVarData1">LVarData1</a> f =&gt; f <a href="Control-LVish-DeepFrz-Internal.html#t:Frzn">Frzn</a> a -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> (f <a href="Control-LVish-DeepFrz-Internal.html#t:Trvrsbl">Trvrsbl</a> a)</p><div class="doc"><p>Here we gain permission to expose the nondeterministic internal structure of an
 LVar: namely, the order in which its contents occur.  We pay the piper with an <code><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a></code>
 action.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>