<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Data.LVar.CycGraph</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Data-LVar-CycGraph.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">lvish-2.0: Parallel scheduler, LVar data structures, and infrastructure to build more.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Data.LVar.CycGraph</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">An idiom for fixed point computations
</a></li><li><a href="#g:2">A parallel version
</a></li><li><a href="#g:3">Debugging aides
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>In contrast with <a href="Data-LVar-Memo.html">Data.LVar.Memo</a>, this module provides a way to run a computation
for each node of a graph WITH support for cycles.  Cycles are explicitly recognized
and then may be handled in an application specific fashion.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:exploreGraph_seq">exploreGraph_seq</a> :: <span class="keyword">forall</span> e s k v. (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> v, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> v) =&gt; (k -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s (<a href="Data-LVar-CycGraph.html#t:Response">Response</a> (<a href="Control-LVish-Internal.html#t:Par">Par</a> e s) k v)) -&gt; (k -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s v) -&gt; k -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s v</li><li class="src short"><span class="keyword">data</span>  <a href="#t:Response">Response</a> par key ans<ul class="subs"><li>= <a href="#v:Done">Done</a> !ans  </li><li>| <a href="#v:Request">Request</a> !key (RequestCont par key ans)  </li></ul></li><li class="src short"><a href="#v:exploreGraph">exploreGraph</a> :: <span class="keyword">forall</span> s k v e. (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> v, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> v, HasPut e, HasGet e, HasFreeze e) =&gt; (k -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s [k]) -&gt; <a href="Data-LVar-CycGraph.html#t:NodeAction">NodeAction</a> e s k v -&gt; k -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s v</li><li class="src short"><span class="keyword">data</span>  <a href="#t:NodeValue">NodeValue</a> k v<ul class="subs"><li>= <a href="#v:FinalValue">FinalValue</a> !v  </li><li>| <a href="#v:Defer">Defer</a> k  </li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:NodeAction">NodeAction</a> e s k v = IsCycle -&gt; k -&gt; [(k, IsCycle, <a href="Data-LVar-IVar.html#t:IVar">IVar</a> s v)] -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s (<a href="Data-LVar-CycGraph.html#t:NodeValue">NodeValue</a> k v)</li><li class="src short"><span class="keyword">class</span> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> t =&gt; <a href="#t:ShortShow">ShortShow</a> t  <span class="keyword">where</span><ul class="subs"><li><a href="#v:shortShow">shortShow</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; t -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a></li></ul></li><li class="src short"><a href="#v:shortTwo">shortTwo</a> :: (<a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> t, <a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> t1) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; t -&gt; t1 -&gt; (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a>, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a>)</li></ul></div><div id="interface"><h1 id="g:1">An idiom for fixed point computations
</h1><div class="top"><p class="src"><a name="v:exploreGraph_seq" class="def">exploreGraph_seq</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> e s k v . (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> v, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> v)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (k -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s (<a href="Data-LVar-CycGraph.html#t:Response">Response</a> (<a href="Control-LVish-Internal.html#t:Par">Par</a> e s) k v))</td><td class="doc"><p>The computation to perform for new requests
</p></td></tr><tr><td class="src">-&gt; (k -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s v)</td><td class="doc"><p>Handler for a cycle on <code>k</code>.  The
 value it returns is in lieu of running
 the main computation at this
 particular node in the graph.
</p></td></tr><tr><td class="src">-&gt; k</td><td class="doc"><p>Key to lookup.
</p></td></tr><tr><td class="src">-&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s v</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>This supercombinator does a parallel depth-first search of a dynamic graph, with
 detection of cycles.
</p><p>Each node in the graph is a computation whose input is the <code>key</code> (the vertex ID).
 Each such computation dynamically computes which other keys it depends on and
 requests the values associated with those keys.
</p><p>This implementation uses a sequential depth-first-search (DFS), starting from the
 initially requested key.  One can picture this search as a directed tree radiating
 from the starting key.  When a cycle is detected at any leaf of this tree, an
 alternate cycle handler is called instead of running the normal computation for
 that key.
</p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Response" class="def">Response</a> par key ans </p><div class="doc"><p>A means of building a dynamic graph.  The node computation returns a response
 which may either be a final value, or a request to explore more nodes (together
 with a continuation for the resulting value).
</p><p>Note that because only one key is requested at a time, this cannot express
 parallel graph traversals.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Done" class="def">Done</a> !ans</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Request" class="def">Request</a> !key (RequestCont par key ans)</td><td class="doc empty">&nbsp;</td></tr></table></div></div><h1 id="g:2">A parallel version
</h1><div class="top"><p class="src"><a name="v:exploreGraph" class="def">exploreGraph</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> s k v e . (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> v, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> v, HasPut e, HasGet e, HasFreeze e)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (k -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s [k])</td><td class="doc"><p>Sketch the graph: map a key onto its children.
</p></td></tr><tr><td class="src">-&gt; <a href="Data-LVar-CycGraph.html#t:NodeAction">NodeAction</a> e s k v</td><td class="doc"><p>The computation to run at each graph node.
</p></td></tr><tr><td class="src">-&gt; k</td><td class="doc"><p>The initial node (key) from which to explore.
</p></td></tr><tr><td class="src">-&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s v</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>This combinator provides parallel exploration of a graph that contains cycles.
 The limitation is that the work to be performed at each node (<code><a href="Data-LVar-CycGraph.html#t:NodeAction">NodeAction</a></code>) is not
 invoked until the graph is fully traversed, i.e. after a barrier.  Thus the graph
 explored is not a <a href="dynamic graph.html">dynamic graph</a> in the sense of being computed on the fly by the
 <code><a href="Data-LVar-CycGraph.html#t:NodeAction">NodeAction</a></code>.
</p><p>The algorithm used in this function is fairly expensive.  For each node, it uses a
 monotonic data structure to track the full set of other nodes that can reach it in
 the graph.
</p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:NodeValue" class="def">NodeValue</a> k v </p><div class="doc"><p>At the end of the handler execution, the value of a node is either ready, or it
 is instead deferred to be exactly the value provided by another key.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:FinalValue" class="def">FinalValue</a> !v</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Defer" class="def">Defer</a> k</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:NodeValue" class="caption collapser" onclick="toggleSection('i:NodeValue')">Instances</p><div id="section.i:NodeValue" class="show"><table><tr><td class="src">(<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> v) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> (<a href="Data-LVar-CycGraph.html#t:NodeValue">NodeValue</a> k v)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">(<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> v) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> (<a href="Data-LVar-CycGraph.html#t:NodeValue">NodeValue</a> k v)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">(<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> k, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> v) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> (<a href="Data-LVar-CycGraph.html#t:NodeValue">NodeValue</a> k v)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:NodeAction" class="def">NodeAction</a> e s k v = IsCycle -&gt; k -&gt; [(k, IsCycle, <a href="Data-LVar-IVar.html#t:IVar">IVar</a> s v)] -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s (<a href="Data-LVar-CycGraph.html#t:NodeValue">NodeValue</a> k v)</p><div class="doc"><p>The handler at a particular node (key) in the graph.  This takes as argument a
   key, along with a boolean indicating whether the current node has been found to
   be part of a cycle.
</p><p>Also, for each child node, this handler is provided a way to demand the
   resulting value of that child node, plus an indication of whether the child node
   participates in a cycle.
</p><p>Finally, this handler is expected to produce a value which becomes associated
   with the key.
</p></div></div><h1 id="g:3">Debugging aides
</h1><div class="top"><p class="src"><span class="keyword">class</span> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> t =&gt; <a name="t:ShortShow" class="def">ShortShow</a> t  <span class="keyword">where</span></p><div class="doc"><p>A show class that tries to stay under a budget.
</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:shortShow" class="def">shortShow</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; t -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a></p></div><div class="subs instances"><p id="control.i:ShortShow" class="caption collapser" onclick="toggleSection('i:ShortShow')">Instances</p><div id="section.i:ShortShow" class="show"><table><tr><td class="src"><a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int8">Int8</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int16">Int16</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int32">Int32</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int64">Int64</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Prelude.html#t:Integer">Integer</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">(<a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> a, <a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> b) =&gt; <a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> (a, b)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:shortTwo" class="def">shortTwo</a> :: (<a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> t, <a href="Data-LVar-CycGraph.html#t:ShortShow">ShortShow</a> t1) =&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a> -&gt; t -&gt; t1 -&gt; (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a>, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a>)</p><div class="doc"><p>Combine two things within a given size budget.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>