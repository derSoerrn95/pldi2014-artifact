<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Control.LVish.Internal</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Control-LVish-Internal.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">lvish-2.0: Parallel scheduler, LVar data structures, and infrastructure to build more.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Unsafe</td></tr></table><p class="caption">Control.LVish.Internal</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Type-safe wrappers around internal components
</a></li><li><a href="#g:2">Unsafe conversions and lifting
</a></li><li><a href="#g:3">Debugging information taken from the environment
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module is <em>not</em> Safe Haskell; as an end-user, you shouldn't ever
need to import it.
</p><p>It is exposed only because it is necessary for implementing <em>new</em> LVar
types that will live in their own, separate packages.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">newtype</span>  <a href="#t:Par">Par</a>  <span class="keyword">where</span><ul class="subs"><li><a href="#v:WrapPar">WrapPar</a> ::  Par a -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s a  </li></ul></li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:LVar">LVar</a> s all delt = <a href="#v:WrapLVar">WrapLVar</a> {<ul class="subs"><li><a href="#v:unWrapLVar">unWrapLVar</a> :: LVar all delt</li></ul>}</li><li class="src short"><a href="#v:unWrapPar">unWrapPar</a> ::  <a href="Control-LVish-Internal.html#t:Par">Par</a> e s a -&gt; Par a</li><li class="src short"><a href="#v:unsafeRunPar">unsafeRunPar</a> ::  <a href="Control-LVish-Internal.html#t:Par">Par</a> e s a -&gt; a</li><li class="src short"><a href="#v:unsafeConvert">unsafeConvert</a> ::  <a href="Control-LVish-Internal.html#t:Par">Par</a> e1 s1 a -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e2 s2 a</li><li class="src short"><a href="#v:unsafeDet">unsafeDet</a> ::  <a href="Control-LVish-Internal.html#t:Par">Par</a> e1 s a -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e2 s a</li><li class="src short"><a href="#v:state">state</a> ::  <a href="Control-LVish-Internal.html#t:LVar">LVar</a> s a d -&gt; a</li><li class="src short"><a href="#v:liftIO">liftIO</a> ::  <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> a -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s a</li><li class="src short"><a href="#v:dbgLvl">dbgLvl</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></li></ul></div><div id="interface"><h1 id="g:1">Type-safe wrappers around internal components
</h1><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:Par" class="def">Par</a>  <span class="keyword">where</span></p><div class="doc"><p>The type of parallel computations.  A computation <code>Par e s a</code> may or may not be
 deterministic based on the setting of the <code>d</code> parameter (of kind <code>Determinism</code>).
 The <code>s</code> parameter is for preventing the escape of <code>LVar</code>s from <code>Par</code> computations
 (just like the <code>ST</code> monad).  
</p><p>Implementation note: This is a wrapper around the internal <code><a href="Control-LVish-Internal.html#t:Par">Par</a></code> type, only with more type parameters.  
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:WrapPar" class="def">WrapPar</a> ::  Par a -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Par" class="caption collapser" onclick="toggleSection('i:Par')">Instances</p><div id="section.i:Par" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Control-Monad.html#t:Monad">Monad</a> (<a href="Control-LVish-Internal.html#t:Par">Par</a> $a $b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Control-Monad.html#t:Functor">Functor</a> (<a href="Control-LVish-Internal.html#t:Par">Par</a> $a $b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Control-Applicative.html#t:Applicative">Applicative</a> (<a href="Control-LVish-Internal.html#t:Par">Par</a> $a $b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Haskell/ghc-7.6.3/lib/transformers-0.3.0.0/doc/html/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> (<a href="Control-LVish-Internal.html#t:Par">Par</a> e s)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">ParThreadSafe (<a href="Control-LVish-Internal.html#t:Par">Par</a> e s)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">ParMonad (<a href="Control-LVish-Internal.html#t:Par">Par</a> e s)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">ParSealed (<a href="Control-LVish-Internal.html#t:Par">Par</a> e s)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">ParIVar (<a href="Control-LVish-Internal.html#t:Par">Par</a> e s)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">ParFuture (<a href="Control-LVish-Internal.html#t:Par">Par</a> e s)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">LVarSched (<a href="Control-LVish-Internal.html#t:Par">Par</a> e s)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">(Deterministic e1, ~ EffectSig e2 (SetF F e1)) =&gt; ParQuasi (<a href="Control-LVish-Internal.html#t:Par">Par</a> e1 s) (<a href="Control-LVish-Internal.html#t:Par">Par</a> e2 s)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">(Deterministic e1, ~ EffectSig e2 (SetF F e1)) =&gt; LVarSchedQ (<a href="Control-LVish-Internal.html#t:Par">Par</a> e1 s) (<a href="Control-LVish-Internal.html#t:Par">Par</a> e2 s)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:LVar" class="def">LVar</a> s all delt </p><div class="doc"><p>The generic representation of LVars used by the scheduler.  The
 end-user can't actually do anything with these and should not try
 to.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:WrapLVar" class="def">WrapLVar</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:unWrapLVar" class="def">unWrapLVar</a> :: LVar all delt</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div></div><h1 id="g:2">Unsafe conversions and lifting
</h1><div class="top"><p class="src"><a name="v:unWrapPar" class="def">unWrapPar</a> ::  <a href="Control-LVish-Internal.html#t:Par">Par</a> e s a -&gt; Par a</p><div class="doc"><p>Unsafe: drops type information to go from the safe <code><a href="Control-LVish-Internal.html#t:Par">Par</a></code> monad to
 the internal, dangerous one.
</p></div></div><div class="top"><p class="src"><a name="v:unsafeRunPar" class="def">unsafeRunPar</a> ::  <a href="Control-LVish-Internal.html#t:Par">Par</a> e s a -&gt; a</p><div class="doc"><p>This is cheating!  It pays no attention to session sealing (<code>s</code>) or to the
 determinism level (<code>d</code>).
</p></div></div><div class="top"><p class="src"><a name="v:unsafeConvert" class="def">unsafeConvert</a> ::  <a href="Control-LVish-Internal.html#t:Par">Par</a> e1 s1 a -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e2 s2 a</p><div class="doc"><p>Ignore the extra type annotations regarding both determinism and session-sealing.
</p></div></div><div class="top"><p class="src"><a name="v:unsafeDet" class="def">unsafeDet</a> ::  <a href="Control-LVish-Internal.html#t:Par">Par</a> e1 s a -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e2 s a</p><div class="doc"><p>Unsafe coercion from quasi-deterministic to deterministic.  The user is
 promising that code is carefully constructed so that put/freeze races will not
 occur.
</p></div></div><div class="top"><p class="src"><a name="v:state" class="def">state</a> ::  <a href="Control-LVish-Internal.html#t:LVar">LVar</a> s a d -&gt; a</p><div class="doc"><p>Extract the state of an LVar.  This should only be used by implementations of
 new LVar data structures.
</p></div></div><div class="top"><p class="src"><a name="v:liftIO" class="def">liftIO</a> ::  <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> a -&gt; <a href="Control-LVish-Internal.html#t:Par">Par</a> e s a</p><div class="doc"><p>Unsafe internal operation to lift IO into the Par monad.
</p></div></div><h1 id="g:3">Debugging information taken from the environment
</h1><div class="top"><p class="src"><a name="v:dbgLvl" class="def">dbgLvl</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></p><div class="doc"><p>Debugging flag shared by several modules.
   This is activated by setting the environment variable <code>DEBUG=1..5</code>.
</p><p>By convention <code>DEBUG=100</code> turns on full sequentialization of the program and
   control over the interleavings in concurrent code, enabling systematic debugging
   of concurrency problems.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>